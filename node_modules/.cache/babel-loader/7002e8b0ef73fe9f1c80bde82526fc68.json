{"remainingRequest":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\babel-loader\\lib\\index.js!F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\A---Spring\\bladeX\\blade\\Saber\\src\\page\\index\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\src\\page\\index\\index.vue","mtime":1592365966717},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from \"vuex\";\nimport tags from \"./tags\";\nimport search from \"./search\";\nimport top from \"./top/\";\nimport sidebar from \"./sidebar/\";\nimport admin from \"@/util/admin\";\nimport { validatenull } from \"@/util/validate\";\nimport { calcDate } from \"@/util/date.js\";\nimport { getStore } from \"@/util/store.js\";\nexport default {\n  components: {\n    top: top,\n    tags: tags,\n    search: search,\n    sidebar: sidebar\n  },\n  name: \"index\",\n  provide: function provide() {\n    return {\n      index: this\n    };\n  },\n  data: function data() {\n    return {\n      //搜索控制\n      isSearch: false,\n      //刷新token锁\n      refreshLock: false,\n      //刷新token的时间\n      refreshTime: \"\"\n    };\n  },\n  created: function created() {\n    //实时检测刷新token\n    this.refreshToken();\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  computed: mapGetters([\"isMenu\", \"isLock\", \"isCollapse\", \"website\", \"menu\"]),\n  props: [],\n  methods: {\n    showCollapse: function showCollapse() {\n      this.$store.commit(\"SET_COLLAPSE\");\n    },\n    // 初始化\n    init: function init() {\n      var _this = this;\n\n      this.$store.commit(\"SET_SCREEN\", admin.getScreen());\n\n      window.onresize = function () {\n        setTimeout(function () {\n          _this.$store.commit(\"SET_SCREEN\", admin.getScreen());\n        }, 0);\n      };\n\n      this.$store.dispatch(\"FlowRoutes\").then(function () {});\n    },\n    //打开菜单\n    openMenu: function openMenu() {\n      var _this2 = this;\n\n      var item = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      this.$store.dispatch(\"GetMenu\", item.id).then(function (data) {\n        if (data.length !== 0) {\n          _this2.$router.$avueRouter.formatRoutes(data, true);\n        } //当点击顶部菜单后默认打开第一个菜单\n\n        /*if (!this.validatenull(item)) {\n          let itemActive = {},\n            childItemActive = 0;\n          if (item.path) {\n            itemActive = item;\n          } else {\n            if (this.menu[childItemActive].length === 0) {\n              itemActive = this.menu[childItemActive];\n            } else {\n              itemActive = this.menu[childItemActive].children[childItemActive];\n            }\n          }\n          this.$store.commit('SET_MENU_ID', item);\n          this.$router.push({\n            path: this.$router.$avueRouter.getPath({\n              name: (itemActive.label || itemActive.name),\n              src: itemActive.path\n            }, itemActive.meta)\n          });\n        }*/\n\n      });\n    },\n    // 定时检测token\n    refreshToken: function refreshToken() {\n      var _this3 = this;\n\n      this.refreshTime = setInterval(function () {\n        var token = getStore({\n          name: \"token\",\n          debug: true\n        }) || {};\n        var date = calcDate(token.datetime, new Date().getTime());\n        if (validatenull(date)) return;\n\n        if (date.seconds >= _this3.website.tokenTime && !_this3.refreshLock) {\n          _this3.refreshLock = true;\n\n          _this3.$store.dispatch(\"refreshToken\").then(function () {\n            _this3.refreshLock = false;\n          }).catch(function () {\n            _this3.refreshLock = false;\n          });\n        }\n      }, 10000);\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"avue-contail\" :class=\"{'avue--collapse':isCollapse}\">\r\n    <div class=\"avue-header\">\r\n      <!-- 顶部导航栏 -->\r\n      <top ref=\"top\"/>\r\n    </div>\r\n    <div class=\"avue-layout\">\r\n      <div class=\"avue-left\">\r\n        <!-- 左侧导航栏 -->\r\n        <sidebar/>\r\n      </div>\r\n      <div class=\"avue-main\">\r\n        <!-- 顶部标签卡 -->\r\n        <tags/>\r\n        <transition name=\"fade-scale\">\r\n          <search class=\"avue-view\" v-show=\"isSearch\"></search>\r\n        </transition>\r\n        <!-- 主体视图层 -->\r\n        <div style=\"height:100%;overflow-y:auto;overflow-x:hidden;\" id=\"avue-view\" v-show=\"!isSearch\">\r\n          <keep-alive>\r\n            <router-view class=\"avue-view\" v-if=\"$route.meta.$keepAlive\"/>\r\n          </keep-alive>\r\n          <router-view class=\"avue-view\" v-if=\"!$route.meta.$keepAlive\"/>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"avue-shade\" @click=\"showCollapse\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import {mapGetters} from \"vuex\";\r\n  import tags from \"./tags\";\r\n  import search from \"./search\";\r\n  import top from \"./top/\";\r\n  import sidebar from \"./sidebar/\";\r\n  import admin from \"@/util/admin\";\r\n  import {validatenull} from \"@/util/validate\";\r\n  import {calcDate} from \"@/util/date.js\";\r\n  import {getStore} from \"@/util/store.js\";\r\n\r\n  export default {\r\n    components: {\r\n      top,\r\n      tags,\r\n      search,\r\n      sidebar\r\n    },\r\n    name: \"index\",\r\n    provide() {\r\n      return {\r\n        index: this\r\n      };\r\n    },\r\n    data() {\r\n      return {\r\n        //搜索控制\r\n        isSearch: false,\r\n        //刷新token锁\r\n        refreshLock: false,\r\n        //刷新token的时间\r\n        refreshTime: \"\"\r\n      };\r\n    },\r\n    created() {\r\n      //实时检测刷新token\r\n      this.refreshToken();\r\n    },\r\n    mounted() {\r\n      this.init();\r\n    },\r\n    computed: mapGetters([\"isMenu\", \"isLock\", \"isCollapse\", \"website\", \"menu\"]),\r\n    props: [],\r\n    methods: {\r\n      showCollapse() {\r\n        this.$store.commit(\"SET_COLLAPSE\");\r\n      },\r\n      // 初始化\r\n      init() {\r\n        this.$store.commit(\"SET_SCREEN\", admin.getScreen());\r\n        window.onresize = () => {\r\n          setTimeout(() => {\r\n            this.$store.commit(\"SET_SCREEN\", admin.getScreen());\r\n          }, 0);\r\n        };\r\n        this.$store.dispatch(\"FlowRoutes\").then(() => {\r\n        });\r\n      },\r\n      //打开菜单\r\n      openMenu(item = {}) {\r\n        this.$store.dispatch(\"GetMenu\", item.id).then(data => {\r\n          if (data.length !== 0) {\r\n            this.$router.$avueRouter.formatRoutes(data, true);\r\n          }\r\n          //当点击顶部菜单后默认打开第一个菜单\r\n          /*if (!this.validatenull(item)) {\r\n            let itemActive = {},\r\n              childItemActive = 0;\r\n            if (item.path) {\r\n              itemActive = item;\r\n            } else {\r\n              if (this.menu[childItemActive].length === 0) {\r\n                itemActive = this.menu[childItemActive];\r\n              } else {\r\n                itemActive = this.menu[childItemActive].children[childItemActive];\r\n              }\r\n            }\r\n            this.$store.commit('SET_MENU_ID', item);\r\n            this.$router.push({\r\n              path: this.$router.$avueRouter.getPath({\r\n                name: (itemActive.label || itemActive.name),\r\n                src: itemActive.path\r\n              }, itemActive.meta)\r\n            });\r\n          }*/\r\n\r\n        });\r\n      },\r\n      // 定时检测token\r\n      refreshToken() {\r\n        this.refreshTime = setInterval(() => {\r\n          const token = getStore({\r\n            name: \"token\",\r\n            debug: true\r\n          }) || {};\r\n          const date = calcDate(token.datetime, new Date().getTime());\r\n          if (validatenull(date)) return;\r\n          if (date.seconds >= this.website.tokenTime && !this.refreshLock) {\r\n            this.refreshLock = true;\r\n            this.$store\r\n              .dispatch(\"refreshToken\")\r\n              .then(() => {\r\n                this.refreshLock = false;\r\n              })\r\n              .catch(() => {\r\n                this.refreshLock = false;\r\n              });\r\n          }\r\n        }, 10000);\r\n      }\r\n    }\r\n  };\r\n</script>\r\n"],"sourceRoot":"src/page/index"}]}