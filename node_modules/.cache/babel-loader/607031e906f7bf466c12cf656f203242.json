{"remainingRequest":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\babel-loader\\lib\\index.js!F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\eslint-loader\\index.js??ref--13-0!F:\\A---Spring\\bladeX\\blade\\Saber\\src\\store\\modules\\user.js","dependencies":[{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\src\\store\\modules\\user.js","mtime":1592365966737},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"F:\\A---Spring\\bladeX\\blade\\Saber\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.is-array\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\nimport _typeof from \"F:/A---Spring/bladeX/blade/Saber/node_modules/@babel/runtime/helpers/esm/typeof\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.for-each\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport { setToken, setRefreshToken, removeToken, removeRefreshToken } from '@/util/auth';\nimport { Message } from 'element-ui';\nimport { setStore, getStore } from '@/util/store';\nimport { isURL, validatenull } from '@/util/validate';\nimport { deepClone } from '@/util/util';\nimport website from '@/config/website';\nimport { loginByUsername, loginBySocial, getUserInfo, logout, refreshToken as _refreshToken, getButtons } from '@/api/user';\nimport { getTopMenu, getRoutes } from '@/api/system/menu';\nimport md5 from 'js-md5';\n\nfunction addPath(ele, first) {\n  var menu = website.menu;\n  var propsConfig = menu.props;\n  var propsDefault = {\n    label: propsConfig.label || 'name',\n    path: propsConfig.path || 'path',\n    icon: propsConfig.icon || 'icon',\n    children: propsConfig.children || 'children'\n  };\n  var icon = ele[propsDefault.icon];\n  ele[propsDefault.icon] = validatenull(icon) ? menu.iconDefault : icon;\n  var isChild = ele[propsDefault.children] && ele[propsDefault.children].length !== 0;\n  if (!isChild) ele[propsDefault.children] = [];\n\n  if (!isChild && first && !isURL(ele[propsDefault.path])) {\n    ele[propsDefault.path] = ele[propsDefault.path] + '/index';\n  } else {\n    ele[propsDefault.children].forEach(function (child) {\n      addPath(child);\n    });\n  }\n}\n\nvar user = {\n  state: {\n    tenantId: getStore({\n      name: 'tenantId'\n    }) || '',\n    userInfo: getStore({\n      name: 'userInfo'\n    }) || [],\n    permission: getStore({\n      name: 'permission'\n    }) || {},\n    roles: [],\n    menu: getStore({\n      name: 'menu'\n    }) || [],\n    menuId: getStore({\n      name: 'menuId'\n    }) || [],\n    menuAll: getStore({\n      name: 'menuAll'\n    }) || [],\n    token: getStore({\n      name: 'token'\n    }) || '',\n    refreshToken: getStore({\n      name: 'refreshToken'\n    }) || ''\n  },\n  actions: {\n    //根据用户名登录\n    LoginByUsername: function LoginByUsername(_ref, userInfo) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve, reject) {\n        loginByUsername(userInfo.tenantId, userInfo.username, md5(userInfo.password), userInfo.type, userInfo.key, userInfo.code).then(function (res) {\n          var data = res.data;\n\n          if (data.error_description) {\n            Message({\n              message: data.error_description,\n              type: 'error'\n            });\n          } else {\n            commit('SET_TOKEN', data.access_token);\n            commit('SET_REFRESH_TOKEN', data.refresh_token);\n            commit('SET_TENANT_ID', data.tenant_id);\n            commit('SET_USER_INFO', data);\n            commit('DEL_ALL_TAG');\n            commit('CLEAR_LOCK');\n          }\n\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    //根据手机号登录\n    LoginByPhone: function LoginByPhone(_ref2, userInfo) {\n      var commit = _ref2.commit;\n      return new Promise(function (resolve) {\n        loginByUsername(userInfo.phone, userInfo.code).then(function (res) {\n          var data = res.data.data;\n          commit('SET_TOKEN', data);\n          commit('DEL_ALL_TAG');\n          commit('CLEAR_LOCK');\n          resolve();\n        });\n      });\n    },\n    //根据第三方信息登录\n    LoginBySocial: function LoginBySocial(_ref3, userInfo) {\n      var commit = _ref3.commit;\n      return new Promise(function (resolve) {\n        loginBySocial(userInfo.tenantId, userInfo.source, userInfo.code, userInfo.state).then(function (res) {\n          var data = res.data;\n\n          if (data.error_description) {\n            Message({\n              message: data.error_description,\n              type: 'error'\n            });\n          } else {\n            commit('SET_TOKEN', data.access_token);\n            commit('SET_REFRESH_TOKEN', data.refresh_token);\n            commit('SET_USER_INFO', data);\n            commit('DEL_ALL_TAG');\n            commit('CLEAR_LOCK');\n          }\n\n          resolve();\n        });\n      });\n    },\n    //获取用户信息\n    GetUserInfo: function GetUserInfo(_ref4) {\n      var commit = _ref4.commit;\n      return new Promise(function (resolve, reject) {\n        getUserInfo().then(function (res) {\n          var data = res.data.data;\n          commit('SET_ROLES', data.roles);\n          resolve(data);\n        }).catch(function (err) {\n          reject(err);\n        });\n      });\n    },\n    //刷新token\n    refreshToken: function refreshToken(_ref5) {\n      var state = _ref5.state,\n          commit = _ref5.commit;\n      window.console.log('handle refresh token');\n      return new Promise(function (resolve, reject) {\n        _refreshToken(state.refreshToken, state.tenantId).then(function (res) {\n          var data = res.data;\n          commit('SET_TOKEN', data.access_token);\n          commit('SET_REFRESH_TOKEN', data.refresh_token);\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 登出\n    LogOut: function LogOut(_ref6) {\n      var commit = _ref6.commit;\n      return new Promise(function (resolve, reject) {\n        logout().then(function () {\n          commit('SET_TOKEN', '');\n          commit('SET_MENU', []);\n          commit('SET_MENU_ID', {});\n          commit('SET_MENU_ALL', []);\n          commit('SET_ROLES', []);\n          commit('SET_TAG_LIST', []);\n          commit('DEL_ALL_TAG');\n          commit('CLEAR_LOCK');\n          removeToken();\n          removeRefreshToken();\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    //注销session\n    FedLogOut: function FedLogOut(_ref7) {\n      var commit = _ref7.commit;\n      return new Promise(function (resolve) {\n        commit('SET_TOKEN', '');\n        commit('SET_MENU_ID', {});\n        commit('SET_MENU_ALL', []);\n        commit('SET_MENU', []);\n        commit('SET_ROLES', []);\n        commit('SET_TAG_LIST', []);\n        commit('DEL_ALL_TAG');\n        commit('CLEAR_LOCK');\n        removeToken();\n        removeRefreshToken();\n        resolve();\n      });\n    },\n    //获取顶部菜单\n    GetTopMenu: function GetTopMenu() {\n      return new Promise(function (resolve) {\n        getTopMenu().then(function (res) {\n          var data = res.data.data || [];\n          resolve(data);\n        });\n      });\n    },\n    //获取系统菜单\n    GetMenu: function GetMenu(_ref8, topMenuId) {\n      var commit = _ref8.commit,\n          dispatch = _ref8.dispatch;\n      return new Promise(function (resolve) {\n        getRoutes(topMenuId).then(function (res) {\n          var data = res.data.data;\n          var menu = deepClone(data);\n          menu.forEach(function (ele) {\n            addPath(ele, true);\n          });\n          commit('SET_MENU_ALL', menu);\n          commit('SET_MENU', menu);\n          dispatch('GetButtons');\n          resolve(menu);\n        });\n      });\n    },\n    //获取系统按钮\n    GetButtons: function GetButtons(_ref9) {\n      var commit = _ref9.commit;\n      return new Promise(function (resolve) {\n        getButtons().then(function (res) {\n          var data = res.data.data;\n          commit('SET_PERMISSION', data);\n          resolve();\n        });\n      });\n    }\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      setToken(token);\n      state.token = token;\n      setStore({\n        name: 'token',\n        content: state.token\n      });\n    },\n    SET_MENU_ID: function SET_MENU_ID(state, menuId) {\n      state.menuId = menuId;\n      setStore({\n        name: 'menuId',\n        content: state.menuId\n      });\n    },\n    SET_MENU_ALL: function SET_MENU_ALL(state, menuAll) {\n      state.menuAll = menuAll;\n      setStore({\n        name: 'menuAll',\n        content: state.menuAll\n      });\n    },\n    SET_MENU: function SET_MENU(state, menu) {\n      state.menu = menu;\n      setStore({\n        name: 'menu',\n        content: state.menu\n      });\n      if (validatenull(menu)) return; //合并动态路由去重\n\n      var menuAll = state.menuAll;\n      menuAll = menuAll.concat(menu).reverse();\n      var newMenu = [];\n\n      var _iterator = _createForOfIteratorHelper(menuAll),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var item1 = _step.value;\n          var flag = true;\n\n          var _iterator2 = _createForOfIteratorHelper(newMenu),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var item2 = _step2.value;\n\n              if (item1.name === item2.name || item1.path === item2.path) {\n                flag = false;\n              }\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n\n          if (flag) {\n            newMenu.push(item1);\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      state.menuAll = newMenu;\n      setStore({\n        name: 'menuAll',\n        content: state.menuAll\n      });\n    },\n    SET_REFRESH_TOKEN: function SET_REFRESH_TOKEN(state, refreshToken) {\n      setRefreshToken(refreshToken);\n      state.refreshToken = refreshToken;\n      setStore({\n        name: 'refreshToken',\n        content: state.refreshToken\n      });\n    },\n    SET_TENANT_ID: function SET_TENANT_ID(state, tenantId) {\n      state.tenantId = tenantId;\n      setStore({\n        name: 'tenantId',\n        content: state.tenantId\n      });\n    },\n    SET_USER_INFO: function SET_USER_INFO(state, userInfo) {\n      if (validatenull(userInfo.avatar)) {\n        userInfo.avatar = \"/img/bg/img-logo.png\";\n      }\n\n      state.userInfo = userInfo;\n      setStore({\n        name: 'userInfo',\n        content: state.userInfo\n      });\n    },\n    SET_ROLES: function SET_ROLES(state, roles) {\n      state.roles = roles;\n    },\n    SET_PERMISSION: function SET_PERMISSION(state, permission) {\n      var result = [];\n\n      function getCode(list) {\n        list.forEach(function (ele) {\n          if (_typeof(ele) === 'object') {\n            var chiildren = ele.children;\n            var code = ele.code;\n\n            if (chiildren) {\n              getCode(chiildren);\n            } else {\n              result.push(code);\n            }\n          }\n        });\n      }\n\n      getCode(permission);\n      state.permission = {};\n      result.forEach(function (ele) {\n        state.permission[ele] = true;\n      });\n      setStore({\n        name: 'permission',\n        content: state.permission\n      });\n    }\n  }\n};\nexport default user;",{"version":3,"sources":["F:/A---Spring/bladeX/blade/Saber/src/store/modules/user.js"],"names":["setToken","setRefreshToken","removeToken","removeRefreshToken","Message","setStore","getStore","isURL","validatenull","deepClone","website","loginByUsername","loginBySocial","getUserInfo","logout","refreshToken","getButtons","getTopMenu","getRoutes","md5","addPath","ele","first","menu","propsConfig","props","propsDefault","label","path","icon","children","iconDefault","isChild","length","forEach","child","user","state","tenantId","name","userInfo","permission","roles","menuId","menuAll","token","actions","LoginByUsername","commit","Promise","resolve","reject","username","password","type","key","code","then","res","data","error_description","message","access_token","refresh_token","tenant_id","catch","error","LoginByPhone","phone","LoginBySocial","source","GetUserInfo","err","window","console","log","LogOut","FedLogOut","GetTopMenu","GetMenu","topMenuId","dispatch","GetButtons","mutations","SET_TOKEN","content","SET_MENU_ID","SET_MENU_ALL","SET_MENU","concat","reverse","newMenu","item1","flag","item2","push","SET_REFRESH_TOKEN","SET_TENANT_ID","SET_USER_INFO","avatar","SET_ROLES","SET_PERMISSION","result","getCode","list","chiildren"],"mappings":"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","sourcesContent":["import {setToken, setRefreshToken, removeToken, removeRefreshToken} from '@/util/auth'\r\nimport {Message} from 'element-ui'\r\nimport {setStore, getStore} from '@/util/store'\r\nimport {isURL, validatenull} from '@/util/validate'\r\nimport {deepClone} from '@/util/util'\r\nimport website from '@/config/website'\r\nimport {loginByUsername, loginBySocial, getUserInfo, logout, refreshToken, getButtons} from '@/api/user'\r\nimport {getTopMenu, getRoutes} from '@/api/system/menu'\r\nimport md5 from 'js-md5'\r\n\r\n\r\nfunction addPath(ele, first) {\r\n  const menu = website.menu;\r\n  const propsConfig = menu.props;\r\n  const propsDefault = {\r\n    label: propsConfig.label || 'name',\r\n    path: propsConfig.path || 'path',\r\n    icon: propsConfig.icon || 'icon',\r\n    children: propsConfig.children || 'children'\r\n  }\r\n  const icon = ele[propsDefault.icon];\r\n  ele[propsDefault.icon] = validatenull(icon) ? menu.iconDefault : icon;\r\n  const isChild = ele[propsDefault.children] && ele[propsDefault.children].length !== 0;\r\n  if (!isChild) ele[propsDefault.children] = [];\r\n  if (!isChild && first && !isURL(ele[propsDefault.path])) {\r\n    ele[propsDefault.path] = ele[propsDefault.path] + '/index'\r\n  } else {\r\n    ele[propsDefault.children].forEach(child => {\r\n      addPath(child);\r\n    })\r\n  }\r\n\r\n}\r\n\r\nconst user = {\r\n  state: {\r\n    tenantId: getStore({name: 'tenantId'}) || '',\r\n    userInfo: getStore({name: 'userInfo'}) || [],\r\n    permission: getStore({name: 'permission'}) || {},\r\n    roles: [],\r\n    menu: getStore({name: 'menu'}) || [],\r\n    menuId: getStore({name: 'menuId'}) || [],\r\n    menuAll: getStore({name: 'menuAll'}) || [],\r\n    token: getStore({name: 'token'}) || '',\r\n    refreshToken: getStore({name: 'refreshToken'}) || '',\r\n  },\r\n  actions: {\r\n    //根据用户名登录\r\n    LoginByUsername({commit}, userInfo) {\r\n      return new Promise((resolve, reject) => {\r\n        loginByUsername(userInfo.tenantId, userInfo.username, md5(userInfo.password), userInfo.type, userInfo.key, userInfo.code).then(res => {\r\n          const data = res.data;\r\n          if (data.error_description) {\r\n            Message({\r\n              message: data.error_description,\r\n              type: 'error'\r\n            })\r\n          } else {\r\n            commit('SET_TOKEN', data.access_token);\r\n            commit('SET_REFRESH_TOKEN', data.refresh_token);\r\n            commit('SET_TENANT_ID', data.tenant_id);\r\n            commit('SET_USER_INFO', data);\r\n            commit('DEL_ALL_TAG');\r\n            commit('CLEAR_LOCK');\r\n          }\r\n          resolve();\r\n        }).catch(error => {\r\n          reject(error);\r\n        })\r\n      })\r\n    },\r\n    //根据手机号登录\r\n    LoginByPhone({commit}, userInfo) {\r\n      return new Promise((resolve) => {\r\n        loginByUsername(userInfo.phone, userInfo.code).then(res => {\r\n          const data = res.data.data;\r\n          commit('SET_TOKEN', data);\r\n          commit('DEL_ALL_TAG');\r\n          commit('CLEAR_LOCK');\r\n          resolve();\r\n        })\r\n      })\r\n    },\r\n    //根据第三方信息登录\r\n    LoginBySocial({commit}, userInfo) {\r\n      return new Promise((resolve) => {\r\n        loginBySocial(userInfo.tenantId, userInfo.source, userInfo.code, userInfo.state).then(res => {\r\n          const data = res.data;\r\n          if (data.error_description) {\r\n            Message({\r\n              message: data.error_description,\r\n              type: 'error'\r\n            })\r\n          } else {\r\n            commit('SET_TOKEN', data.access_token);\r\n            commit('SET_REFRESH_TOKEN', data.refresh_token);\r\n            commit('SET_USER_INFO', data);\r\n            commit('DEL_ALL_TAG');\r\n            commit('CLEAR_LOCK');\r\n          }\r\n          resolve();\r\n        })\r\n      })\r\n    },\r\n    //获取用户信息\r\n    GetUserInfo({commit}) {\r\n      return new Promise((resolve, reject) => {\r\n        getUserInfo().then((res) => {\r\n          const data = res.data.data;\r\n          commit('SET_ROLES', data.roles);\r\n          resolve(data);\r\n        }).catch(err => {\r\n          reject(err);\r\n        })\r\n      })\r\n    },\r\n    //刷新token\r\n    refreshToken({state, commit}) {\r\n      window.console.log('handle refresh token')\r\n      return new Promise((resolve, reject) => {\r\n        refreshToken(state.refreshToken, state.tenantId).then(res => {\r\n          const data = res.data;\r\n          commit('SET_TOKEN', data.access_token);\r\n          commit('SET_REFRESH_TOKEN', data.refresh_token);\r\n          resolve();\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n    // 登出\r\n    LogOut({commit}) {\r\n      return new Promise((resolve, reject) => {\r\n        logout().then(() => {\r\n          commit('SET_TOKEN', '');\r\n          commit('SET_MENU', []);\r\n          commit('SET_MENU_ID', {});\r\n          commit('SET_MENU_ALL', []);\r\n          commit('SET_ROLES', []);\r\n          commit('SET_TAG_LIST', []);\r\n          commit('DEL_ALL_TAG');\r\n          commit('CLEAR_LOCK');\r\n          removeToken();\r\n          removeRefreshToken();\r\n          resolve();\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n    //注销session\r\n    FedLogOut({commit}) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '');\r\n        commit('SET_MENU_ID', {});\r\n        commit('SET_MENU_ALL', []);\r\n        commit('SET_MENU', []);\r\n        commit('SET_ROLES', []);\r\n        commit('SET_TAG_LIST', []);\r\n        commit('DEL_ALL_TAG');\r\n        commit('CLEAR_LOCK');\r\n        removeToken();\r\n        removeRefreshToken();\r\n        resolve();\r\n      })\r\n    },\r\n    //获取顶部菜单\r\n    GetTopMenu() {\r\n      return new Promise(resolve => {\r\n        getTopMenu().then((res) => {\r\n          const data = res.data.data || [];\r\n          resolve(data)\r\n        })\r\n      })\r\n    },\r\n    //获取系统菜单\r\n    GetMenu({commit, dispatch}, topMenuId) {\r\n      return new Promise(resolve => {\r\n        getRoutes(topMenuId).then((res) => {\r\n          const data = res.data.data\r\n          let menu = deepClone(data);\r\n          menu.forEach(ele => {\r\n            addPath(ele, true);\r\n          });\r\n          commit('SET_MENU_ALL', menu)\r\n          commit('SET_MENU', menu)\r\n          dispatch('GetButtons');\r\n          resolve(menu)\r\n        })\r\n      })\r\n    },\r\n    //获取系统按钮\r\n    GetButtons({commit}) {\r\n      return new Promise((resolve) => {\r\n        getButtons().then(res => {\r\n          const data = res.data.data;\r\n          commit('SET_PERMISSION', data);\r\n          resolve();\r\n        })\r\n      })\r\n    },\r\n  },\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      setToken(token);\r\n      state.token = token;\r\n      setStore({name: 'token', content: state.token})\r\n    },\r\n    SET_MENU_ID(state, menuId) {\r\n      state.menuId = menuId;\r\n      setStore({name: 'menuId', content: state.menuId})\r\n    },\r\n    SET_MENU_ALL: (state, menuAll) => {\r\n      state.menuAll = menuAll\r\n      setStore({name: 'menuAll', content: state.menuAll})\r\n    },\r\n    SET_MENU: (state, menu) => {\r\n      state.menu = menu\r\n      setStore({name: 'menu', content: state.menu})\r\n      if (validatenull(menu)) return;\r\n      //合并动态路由去重\r\n      let menuAll = state.menuAll;\r\n      menuAll = menuAll.concat(menu).reverse();\r\n      let newMenu = [];\r\n      for (let item1 of menuAll) {\r\n        let flag = true;\r\n        for (let item2 of newMenu) {\r\n          if (item1.name === item2.name || item1.path === item2.path) {\r\n            flag = false;\r\n          }\r\n        }\r\n        if (flag) {\r\n          newMenu.push(item1);\r\n        }\r\n      }\r\n      state.menuAll = newMenu;\r\n      setStore({name: 'menuAll', content: state.menuAll})\r\n    },\r\n    SET_REFRESH_TOKEN: (state, refreshToken) => {\r\n      setRefreshToken(refreshToken)\r\n      state.refreshToken = refreshToken;\r\n      setStore({name: 'refreshToken', content: state.refreshToken})\r\n    },\r\n    SET_TENANT_ID: (state, tenantId) => {\r\n      state.tenantId = tenantId;\r\n      setStore({name: 'tenantId', content: state.tenantId})\r\n    },\r\n    SET_USER_INFO: (state, userInfo) => {\r\n      if (validatenull(userInfo.avatar)) {\r\n        userInfo.avatar = \"/img/bg/img-logo.png\";\r\n      }\r\n      state.userInfo = userInfo;\r\n      setStore({name: 'userInfo', content: state.userInfo})\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles;\r\n    },\r\n    SET_PERMISSION: (state, permission) => {\r\n      let result = [];\r\n\r\n      function getCode(list) {\r\n        list.forEach(ele => {\r\n          if (typeof (ele) === 'object') {\r\n            const chiildren = ele.children;\r\n            const code = ele.code;\r\n            if (chiildren) {\r\n              getCode(chiildren)\r\n            } else {\r\n              result.push(code);\r\n            }\r\n          }\r\n        })\r\n      }\r\n\r\n      getCode(permission);\r\n      state.permission = {};\r\n      result.forEach(ele => {\r\n        state.permission[ele] = true;\r\n      });\r\n      setStore({name: 'permission', content: state.permission})\r\n    }\r\n  }\r\n\r\n}\r\nexport default user\r\n"]}]}